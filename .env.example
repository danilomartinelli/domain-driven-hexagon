# =============================================================================
# Docker Optimization Environment Variables
# Copy this file to .env and update values for your environment
# =============================================================================

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
NODE_ENV=development
LOG_LEVEL=debug

# Node.js Runtime Optimization
NODE_OPTIONS=--max-old-space-size=1024 --enable-source-maps
UV_THREADPOOL_SIZE=128

# Security Settings
NODE_TLS_REJECT_UNAUTHORIZED=1

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30s

# =============================================================================
# DOCKER BUILD CONFIGURATION
# =============================================================================
# Build target for Docker Compose (development|production|testing)
BUILD_TARGET=development

# Container registry (for multi-registry deployments)
REGISTRY=ddh

# Platform targets for multi-arch builds
PLATFORMS=linux/amd64,linux/arm64

# Enable Docker BuildKit features
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL Configuration
DB_HOST=postgres
DB_PORT=5432
DB_USERNAME=user
DB_PASSWORD=password
DB_NAME=ddh
DB_SSL=false

# Connection Pool Settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=60000
DB_STATEMENT_TIMEOUT=60000

# Database Performance Tuning
DB_SHARED_BUFFERS=256MB
DB_EFFECTIVE_CACHE_SIZE=1GB
DB_MAINTENANCE_WORK_MEM=64MB
DB_WORK_MEM=4MB
DB_WAL_BUFFERS=16MB

# Connection URL (auto-generated from above values)
DATABASE_URL=postgresql://${DB_USERNAME}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_MAX_MEMORY=256mb
REDIS_EVICTION_POLICY=allkeys-lru

# Connection URL
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# =============================================================================
# RABBITMQ CONFIGURATION
# =============================================================================
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USERNAME=user
RABBITMQ_PASSWORD=password
RABBITMQ_VHOST=ddh
RABBITMQ_MANAGEMENT_PORT=15672

# Performance Tuning
RABBITMQ_VM_MEMORY_HIGH_WATERMARK=0.6
RABBITMQ_DISK_FREE_LIMIT=1GB
RABBITMQ_CONSUMER_TIMEOUT=31622400000

# Connection URL
RABBITMQ_URL=amqp://${RABBITMQ_USERNAME}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}/${RABBITMQ_VHOST}

# =============================================================================
# APPLICATION PORTS
# =============================================================================
APP_PORT=3000
DEBUG_PORT=9229

# Service Ports (for external access)
POSTGRES_EXTERNAL_PORT=5432
REDIS_EXTERNAL_PORT=6379
RABBITMQ_EXTERNAL_PORT=5672
RABBITMQ_MANAGEMENT_EXTERNAL_PORT=15672

# Production Services
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# Monitoring Ports
PROMETHEUS_PORT=9090
GRAFANA_PORT=3001

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# JWT Configuration (if using authentication)
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=3600

# CORS Configuration
CORS_ORIGINS=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Application Logging
LOG_FORMAT=json
LOG_TIMESTAMP=true
LOG_COLORIZE=false

# Database Query Logging
DB_ENABLE_QUERY_LOGGING=false
DB_LOG_SLOW_QUERIES=true
DB_SLOW_QUERY_THRESHOLD=1000

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Application Metrics
METRICS_ENABLED=true
METRICS_PATH=/metrics
METRICS_PORT=9464

# Health Check Endpoints
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/alive

# Prometheus Configuration
PROMETHEUS_SCRAPE_INTERVAL=30s
PROMETHEUS_EVALUATION_INTERVAL=30s

# Grafana Configuration
GRAFANA_ADMIN_PASSWORD=admin123
GRAFANA_ALLOW_SIGN_UP=false
GRAFANA_ANONYMOUS_ENABLED=false

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================
# Hot Reload Settings
CHOKIDAR_USEPOLLING=false
CHOKIDAR_INTERVAL=1000

# Development Database (for local development without Docker)
DEV_DB_HOST=localhost
DEV_REDIS_HOST=localhost
DEV_RABBITMQ_HOST=localhost

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================
# Test Database Configuration
TEST_DB_HOST=postgres
TEST_DB_PORT=5432
TEST_DB_USERNAME=user
TEST_DB_PASSWORD=password
TEST_DB_NAME=ddh_test

# Test Environment Settings
TEST_TIMEOUT=30000
TEST_COVERAGE_THRESHOLD=80

# =============================================================================
# PRODUCTION CONFIGURATION
# =============================================================================
# Production Security
SECURE_COOKIES=true
TRUST_PROXY=true
HELMET_ENABLED=true

# Performance Settings
COMPRESSION_ENABLED=true
CACHE_TTL=3600

# SSL Configuration (for production)
SSL_CERT_PATH=/etc/ssl/certs/cert.pem
SSL_KEY_PATH=/etc/ssl/private/key.pem
SSL_ENABLED=false

# =============================================================================
# RESOURCE LIMITS
# =============================================================================
# Container Resource Limits (for Docker Compose deploy section)
APP_CPU_LIMIT=2.0
APP_MEMORY_LIMIT=1G
APP_CPU_RESERVATION=1.0
APP_MEMORY_RESERVATION=512M

POSTGRES_CPU_LIMIT=1.5
POSTGRES_MEMORY_LIMIT=1G
POSTGRES_CPU_RESERVATION=0.5
POSTGRES_MEMORY_RESERVATION=512M

REDIS_CPU_LIMIT=0.5
REDIS_MEMORY_LIMIT=512M
REDIS_CPU_RESERVATION=0.2
REDIS_MEMORY_RESERVATION=256M

RABBITMQ_CPU_LIMIT=1.0
RABBITMQ_MEMORY_LIMIT=512M
RABBITMQ_CPU_RESERVATION=0.3
RABBITMQ_MEMORY_RESERVATION=256M

# =============================================================================
# VOLUMES & DATA PERSISTENCE
# =============================================================================
# Data Directory Paths (relative to project root)
POSTGRES_DATA_PATH=./data/postgres
REDIS_DATA_PATH=./data/redis
RABBITMQ_DATA_PATH=./data/rabbitmq
LOGS_PATH=./logs

# Backup Configuration
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=./backups

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================
# Email Configuration (if using email features)
SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@example.com

# Cloud Storage (if using file uploads)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
AWS_S3_BUCKET=

# External APIs
EXTERNAL_API_URL=
EXTERNAL_API_KEY=
EXTERNAL_API_TIMEOUT=30000

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_MONITORING_ENABLED=true
FEATURE_SECURITY_SCANNING_ENABLED=true
FEATURE_PERFORMANCE_PROFILING_ENABLED=false
FEATURE_DEBUG_MODE_ENABLED=false